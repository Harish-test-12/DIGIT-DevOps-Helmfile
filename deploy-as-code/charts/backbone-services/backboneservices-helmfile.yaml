repositories:
- name: bitnami
  url: https://charts.bitnami.com/bitnami

templates:
  default: &default
    namespace: backbone-helmfile
    missingFileHandler: Warn

values:
  - ../environments/dev-secrets.yaml

releases:
- name: cert-manager
  chart: ./cert-manager
  installed: true
  version: 0.5.2
  <<: *default
  values:
    - ./cert-manager/values.yaml

- name: minio
  installed: true
  chart: ./minio
  version: 0.1.0
  <<: *default
  values:
    - ./minio/values.yaml

- name: postgresql
  installed: true
  chart: ./postgresql
  version: 11.9.13
  <<: *default
  values:
    - ./postgresql/values.yaml
    - global:
        postgresql:
          auth:
            postgresPassword: {{ .Values.secrets.db.password | quote }}
- name: redis
  installed: true
  chart: ./redis
  version: 3.0.0
  <<: *default
  values:
    - ./redis/values.yaml

- name: elasticsearch
  chart: ./elasticsearch
  version: 7.6.1
  <<: *default
  values:
    - ./elasticsearch/values.yaml
    - secret:
        password: {{ .Values.secrets.elasticsearch.password }}

- name: elasticsearch-data
  chart: ./elasticsearch-data
  version: 7.6.1
  <<: *default
  values:
    - ./elasticsearch-data/values.yaml

- name: kibana
  chart: ./kibana
  version: 1.0.0
  force: true
  <<: *default
  values:
    - ./kibana/values.yaml

- name: kafka-kraft
  installed: true
  chart: ./kafka-kraft
  version: 1.0.0
  <<: *default
  values:
    - ./kafka-kraft/values.yaml
  set:
    - name: kraft.clusterId
      value: {{ .Values.secrets.kafka.clusterID }}

- name: ingress-nginx
  installed: true
  chart: ./ingress-nginx
  version: 1.0.0
  <<: *default
  values:
    - ./ingress-nginx/values.yaml
